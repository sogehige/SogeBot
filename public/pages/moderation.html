<div class="row">
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title">
      <span data-lang="links"></span>
      <input id="moderationLinksToggle" type="checkbox" data-size="mini" data-onstyle="success" data-offstyle="danger">
    </div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationLinksTimeout" onclick="commons.configEditable(this, 's')" id="moderationLinksTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationLinksTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationLinksTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>

<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title">
      <span data-lang="symbols"></span>
      <input id="moderationSymbolsToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
    </div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationSymbolsTimeout" onclick="commons.configEditable(this, 's')" id="moderationSymbolsTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationSymbolsTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationSymbolsTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="trigger-length-of-message"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationSymbolsTriggerLength" onclick="commons.configEditable(this, '')" id="moderationSymbolsTriggerLength"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationSymbolsTriggerLength_group">
            <input style="width: 6em" id="input_moderationSymbolsTriggerLength" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="max-symbols-consecutively"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationSymbolsMaxConsecutively" onclick="commons.configEditable(this, '')" id="moderationSymbolsMaxConsecutively"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationSymbolsMaxConsecutively_group">
            <input style="width: 6em" id="input_moderationSymbolsMaxConsecutively" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="max-symbols-percentage"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationSymbolsMaxPercent" onclick="commons.configEditable(this, '%')" id="moderationSymbolsMaxPercent"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationSymbolsMaxPercent_group">
            <div class="input-group-addon">%</div>
            <input style="width: 6em" id="input_moderationSymbolsMaxPercent" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>

<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title">
      <span data-lang="long-messages"></span>
      <input id="moderationLongMessageToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
    </div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationLongMessageTimeout" onclick="commons.configEditable(this, 's')" id="moderationLongMessageTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationLongMessageTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationLongMessageTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="trigger-length-of-message"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationLongMessageTriggerLength" onclick="commons.configEditable(this, '')" id="moderationLongMessageTriggerLength"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationLongMessageTriggerLength_group">
            <input style="width: 6em" id="input_moderationLongMessageTriggerLength" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>

<div class="row">
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title">
      <span data-lang="capitals"></span>
      <input id="moderationCapsToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
    </div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationCapsTimeout" onclick="commons.configEditable(this, 's')" id="moderationCapsTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationCapsTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationCapsTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="trigger-length-of-message"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationCapsTriggerLength" onclick="commons.configEditable(this, '')" id="moderationCapsTriggerLength"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationCapsTriggerLength_group">
            <input style="width: 6em" id="input_moderationCapsTriggerLength" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="max-capitals-percentage"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationCapsMaxPercent" onclick="commons.configEditable(this, '%')" id="moderationCapsMaxPercent"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationCapsMaxPercent_group">
            <div class="input-group-addon">%</div>
            <input style="width: 6em" id="input_moderationCapsMaxPercent" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>

<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title">
      <span data-lang="spam"></span>
      <input id="moderationSpamToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
    </div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationSpamTimeout" onclick="commons.configEditable(this, 's')" id="moderationSpamTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationSpamTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationSpamTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="trigger-length-of-message"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationSpamTriggerLength" onclick="commons.configEditable(this, '')" id="moderationSpamTriggerLength"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationSpamTriggerLength_group">
            <input style="width: 6em" id="input_moderationSpamTriggerLength" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="max-spam-length"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationSpamMaxLength" onclick="commons.configEditable(this, '')" id="moderationSpamMaxLength"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationSpamMaxLength_group">
            <input style="width: 6em" id="input_moderationSpamMaxLength" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title">
      <span data-lang="colors"></span>
      <input id="moderationColorToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
    </div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationColorTimeout" onclick="commons.configEditable(this, 's')" id="moderationColorTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationColorTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationColorTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>

<div class="row">
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title">
      <span data-lang="emotes"></span>
      <input id="moderationEmotesToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
    </div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationEmotesTimeout" onclick="commons.configEditable(this, 's')" id="moderationEmotesTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationEmotesTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationEmotesTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="max-emotes-in-message"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationEmotesMaxCount" onclick="commons.configEditable(this, '')" id="moderationEmotesMaxCount"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationEmotesMaxCount_group">
            <input style="width: 6em" id="input_moderationEmotesMaxCount" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title" data-lang="timeout-settings"></div>
    <table class="table table-striped">
      <tr>
        <td><strong data-lang="warnings-before-user-timeout"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationWarnings" onclick="commons.configEditable(this, '')" id="moderationWarnings"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationWarnings_group">
            <input style="width: 6em" id="input_moderationWarnings" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
      <tr>
        <td><strong data-lang="warning-should-be-timeout"></strong></td>
        <td>
          <input id="moderationWarningsTimeoutsToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
        </td>
      </tr>
      <tr>
        <td><strong data-lang="announce-timeouts-in-chat"></strong></td>
        <td>
          <input id="moderationAnnounceTimeoutsToggle" type="checkbox" data-toggle="toggle"  data-size="mini" data-onstyle="success" data-offstyle="danger">
        </td>
      </tr>
    </table>
  </div>
</div>
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title"><span data-lang="timeout-blacklist"></span> <small data-lang="one-record-per-line"></small></div>
    <textarea class="form-control" rows="10" id="blacklist"></textarea>

    <table class="table table-striped">
      <tr>
        <td><strong data-lang="timeout-duration"></strong></td>
        <td>
          <abbr title="click to edit" data-config-id="moderationBlacklistTimeout" onclick="commons.configEditable(this, 's')" id="moderationBlacklistTimeout"></abbr>
          <div class="input-group" style="display:none;" id="input_moderationBlacklistTimeout_group">
            <div class="input-group-addon" data-lang="seconds"></div>
            <input style="width: 6em" id="input_moderationBlacklistTimeout" class="form-control input-sm" type="text"/>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
  <div class="widget">
    <div class="title"><span data-lang="timeout-whitelist"></span> <small data-lang="one-record-per-line"></small></div>
    <textarea class="form-control" rows="10" id="whitelist"></textarea>
  </div>
</div>
</div>

<script>
  socket.emit('getConfiguration')
  socket.emit('moderation.lists.get')

  var createToggle = function (id, value, options) {
    options = options || {on: translations['on'], off: translations['off']}
    $('#' + id + 'Toggle').bootstrapToggle(options)
    $('#' + id + 'Toggle').bootstrapToggle(value ? 'on' : 'off')
    $('#' + id + 'Toggle').off('change')
    $('#' + id + 'Toggle').change(function() {
      var data = {}
      data[id] = $(this).prop('checked')
      if ($('#' + id + 'Toggle').data('init')) socket.emit('saveConfiguration', data)
    })
    $('#' + id + 'Toggle').data('init', true)
  }

  socket.off('configuration')
  socket.on('configuration', function(data) {
    createToggle('moderationLinks', data.moderationLinks)
    $("#moderationLinksTimeout").text(data.moderationLinksTimeout + 's')

    createToggle('moderationSymbols', data.moderationSymbols)
    $("#moderationSymbolsTimeout").text(data.moderationSymbolsTimeout + 's')
    $("#moderationSymbolsTriggerLength").text(data.moderationSymbolsTriggerLength)
    $("#moderationSymbolsMaxConsecutively").text(data.moderationSymbolsMaxConsecutively)
    $("#moderationSymbolsMaxPercent").text(data.moderationSymbolsMaxPercent + '%')

    createToggle('moderationLongMessage', data.moderationLongMessage)
    $("#moderationLongMessageTimeout").text(data.moderationLongMessageTimeout + 's')
    $("#moderationLongMessageTriggerLength").text(data.moderationLongMessageTriggerLength)

    createToggle('moderationCaps', data.moderationCaps)
    $("#moderationCapsTimeout").text(data.moderationCapsTimeout + 's')
    $("#moderationCapsTriggerLength").text(data.moderationCapsTriggerLength)
    $("#moderationCapsMaxPercent").text(data.moderationCapsMaxPercent + '%')

    createToggle('moderationSpam', data.moderationSpam)
    $("#moderationSpamTimeout").text(data.moderationSpamTimeout + 's')
    $("#moderationSpamTriggerLength").text(data.moderationSpamTriggerLength)
    $("#moderationSpamMaxLength").text(data.moderationSpamMaxLength)

    createToggle('moderationColor', data.moderationColor)
    $("#moderationColorTimeout").text(data.moderationColorTimeout + 's')

    createToggle('moderationEmotes', data.moderationEmotes)
    $("#moderationEmotesTimeout").text(data.moderationEmotesTimeout + 's')
    $("#moderationEmotesMaxCount").text(data.moderationEmotesMaxCount)

    $("#moderationBlacklistTimeout").text(data.moderationBlacklistTimeout + 's')

    $("#moderationWarnings").text(data.moderationWarnings)
    createToggle('moderationWarningsTimeouts', data.moderationWarningsTimeouts, {on: translations['timeout'], off: translations['warning']})

    $("#moderationAnnounceTimeouts").text(data.moderationAnnounceTimeouts)
    createToggle('moderationAnnounceTimeouts', data.moderationAnnounceTimeouts, {on: translations['announce'], off: translations['muted']})
  })

  socket.off('moderation.lists')
  socket.on('moderation.lists', function(lists) {
    $('#blacklist').val(lists.blacklist.join('\n'))
    $('#whitelist').val(lists.whitelist.join('\n'))
  })

  $('#blacklist, #whitelist').off().on('focusout', function (ev) {
    socket.emit('moderation.lists.set', { blacklist: $('#blacklist').val().split('\n'), whitelist: $('#whitelist').val().split('\n') })
  })
</script>